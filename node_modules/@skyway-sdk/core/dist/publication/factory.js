"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createPublication = void 0;
const _1 = require(".");
/**@internal */
function createPublication(channel, { publisherId, stream, origin, metadata, codecCapabilities, encodings, contentType, id, isEnabled, }) {
    const exist = channel._getPublication(id);
    if (exist) {
        return exist;
    }
    contentType = contentType.toLowerCase();
    const originPublication = origin
        ? // todo fix originPublicationが不整合を起こすことがある
            channel._getPublication(origin)
        : undefined;
    // リレーされたPublicationのencodingsを設定する
    if (originPublication) {
        if (encodings.length === 0) {
            encodings = originPublication.encodings;
        }
    }
    const publication = new _1.PublicationImpl({
        id,
        channel,
        publisher: channel._getMember(publisherId),
        contentType,
        metadata,
        origin: originPublication,
        stream,
        codecCapabilities: codecCapabilities !== null && codecCapabilities !== void 0 ? codecCapabilities : [],
        encodings,
        isEnabled,
    });
    return publication;
}
exports.createPublication = createPublication;
//# sourceMappingURL=factory.js.map